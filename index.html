<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance V.92 - Hybrid Edition (Customized)</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        :root { 
            --glass-bg: rgba(255, 255, 255, 0.95);
            --deep-orange: #e65100;
            --bright-orange: #ff8c00;
            --bg-liquid: linear-gradient(135deg, #fff5e6 0%, #ffffff 100%);
        }
        body { font-family: 'Prompt', sans-serif; background: var(--bg-liquid); min-height: 100vh; color: #2d3436; margin: 0; }
        .glass-card { background: var(--glass-bg); backdrop-filter: blur(15px); border-radius: 20px; border: 1px solid rgba(255,255,255,0.4); box-shadow: 0 4px 15px rgba(0,0,0,0.05); padding: 20px; margin-bottom: 15px; }
        
        .nav-btn { border: none; background: none; color: #636e72; font-weight: 600; padding: 10px; transition: 0.3s; flex: 1; font-size: 0.85rem; }
        .nav-btn.active-btn { background: var(--bright-orange); color: white; border-radius: 12px; box-shadow: 0 4px 10px rgba(255,140,0,0.3); }
        
        .count-circle {
            background: linear-gradient(135deg, #ff9100, #ffea00);
            color: white; width: 26px; height: 26px; border-radius: 50%;
            display: inline-flex; align-items: center; justify-content: center;
            font-size: 0.75rem; font-weight: bold; margin-right: 4px; 
            box-shadow: 0 2px 4px rgba(255,140,0,0.3);
        }

/* Filter UI - ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏á 5 ‡∏ä‡πà‡∏≠‡∏á ‡∏™‡∏π‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏û‡∏≠‡∏î‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ */
        .filter-row { 
            display: grid; 
            grid-template-columns: repeat(5, 1fr); 
            gap: 10px; 
            padding-bottom: 15px; 
            /* ‡∏õ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å end ‡πÄ‡∏õ‡πá‡∏ô stretch ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏™‡∏π‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô */
            align-items: stretch; 
            width: 100%;
        }

        .filter-box { 
            background: white; 
            border: 1px solid #ddd; 
            border-radius: 10px; 
            padding: 8px 10px;
            min-width: 0; 
            display: flex;
            flex-direction: column;
        }

        /* ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (Select) ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏™‡∏π‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏û‡∏≠‡∏î‡∏µ‡∏Å‡∏•‡πà‡∏≠‡∏á */
        .filter-box select {
            width: 100%;
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 4px;
            margin-top: 5px;
            /* ‡∏ó‡∏≥‡πÉ‡∏´‡πâ Select ‡∏Ç‡∏¢‡∏≤‡∏¢‡πÄ‡∏ï‡πá‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÉ‡∏ô‡∏Å‡∏•‡πà‡∏≠‡∏á */
            flex-grow: 1; 
        }

        /* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏Ñ‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏ß‡∏Å Multi-select (‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏ß‡∏±‡∏ô) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏ñ‡∏ß‡∏î‡∏π‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö */
        .filter-box select[multiple] {
            min-height: 60px; 
        }

        .filter-label {
            font-weight: bold;
            font-size: 0.9rem;
            color: #555;
        }

        .loader-spinner { width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid var(--bright-orange); border-radius: 50%; animation: spin 1s linear infinite; margin: 20px auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .progress-wrapper { background: rgba(0,0,0,0.05); height: 26px; border-radius: 13px; overflow: hidden; position: relative; }
        .progress-bar-fill { height: 100%; width: 0%; background: linear-gradient(90deg, #ff8c00, #ffb347, #ff8c00); transition: width 1s ease; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 0.8rem; }
        
        .cp-table-render { width: 100%; border-collapse: separate; border-spacing: 0; font-size: 0.85rem; background: white; border-radius: 15px; overflow: hidden; border: 1px solid #eee; }
        .cp-table-render td { padding: 10px 15px; border-bottom: 1px solid #f0f0f0; }
        .cp-label-custom { background-color: #fff8e1; font-weight: 600; color: var(--deep-orange); width: 40%; border-right: 1px solid #f0f0f0; }
        .cp-value-custom { background-color: #ffffff; color: #333; }
        .cp-section-title { background: linear-gradient(90deg, var(--bright-orange), var(--deep-orange)); color: white; font-weight: bold; padding: 8px 15px; font-size: 0.9rem; }

        .hidden-completely { display: none !important; }
        .cat-input { text-align: center; font-weight: bold; border-radius: 8px !important; }
        #historyContent { transition: all 0.3s ease; }
        .btn-toggle-history { font-size: 0.8rem; border-radius: 10px; }
        
        /* Table Summary scroll */
        .table-dash-wrapper { max-height: 400px; overflow-y: auto; border-radius: 10px; border: 1px solid #eee; }
        .table-dash-sticky thead th { position: sticky; top: 0; background: #f8f9fa; z-index: 5; }
    </style>
</head>
<body>

<div id="loginSection" style="position:fixed; width:100%; height:100%; z-index:9999; background:var(--bg-liquid); display:flex; align-items:center; justify-content:center;">
    <div class="glass-card text-center" style="width:90%; max-width:350px;">
        <h3 class="fw-bold mb-4" style="color:var(--deep-orange)">üçä Performance</h3>
        <div id="loginInputs">
            <input type="text" id="user" class="form-control rounded-pill mb-3" placeholder="Username">
            <input type="password" id="pass" class="form-control rounded-pill mb-4" placeholder="Password">
            <button onclick="login()" class="btn btn-warning w-100 fw-bold text-white rounded-pill py-2 shadow">LOGIN</button>
        </div>
        <div id="loginStatus" class="hidden-completely">
            <div class="loader-spinner"></div>
            <p class="mb-1 fw-bold text-secondary">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö...</p>
            <p id="targetUserDisplay" class="text-warning small"></p>
        </div>
    </div>
</div>

<div id="mainSection" class="hidden-completely">
    <nav class="navbar mb-2 p-2 glass-card mx-2 mt-2">
        <div class="container d-flex justify-content-between p-0 align-items-center">
            <span class="fw-bold" style="color:var(--bright-orange)">üçä PERFORMANCE V.92</span>
            <div class="text-end small"><b><span id="empName"></span></b> | <a href="#" onclick="logout()" class="text-danger">‡∏≠‡∏≠‡∏Å</a></div>
        </div>
    </nav>

    <div class="container pb-5">
        <div class="d-flex gap-1 mb-3 p-1 glass-card" style="border-radius: 15px; overflow-x: auto;">
            <button id="nav-record" class="btn nav-btn active-btn" onclick="showTab('record')">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            <button id="nav-cp" class="btn nav-btn" onclick="showTab('cp')">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î CP</button>
            <button id="nav-dash" class="btn nav-btn" onclick="showTab('dash')">‡∏™‡∏£‡∏∏‡∏õ</button>
            <button id="nav-assign" class="btn nav-btn" onclick="showTab('assign')">‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô</button>
        </div>

        <div id="tab-record" class="tab-content">
            <div class="glass-card text-center mb-3">
                <div class="d-flex justify-content-between align-items-start mb-2">
                    <div class="text-start">
                        <div class="small fw-bold text-secondary" id="todayDateLabel"></div>
                        <div id="bigClock" style="font-size: 1.8rem; font-weight:700; color:var(--deep-orange); line-height: 1;">00:00:00</div>
                    </div>
                    <div class="text-end">
                        <button class="btn btn-sm btn-outline-warning rounded-pill px-3" onclick="initData()"><i class="fa-solid fa-sync"></i> Sync</button>
                        <div class="small text-muted mt-1" id="lastSyncTime" style="font-size: 0.7rem;"></div>
                    </div>
                </div>
                <div class="mb-3">
                    <span class="badge rounded-pill bg-success p-2 px-3"><i class="fa-solid fa-check-circle me-1"></i> Auto Sync: On</span>
                </div>
                <div class="progress-wrapper mb-3"><div id="goalProgress" class="progress-bar-fill">0%</div></div>
                <div class="row g-2 mb-4">
                    <div class="col-4 small">Target<br><b id="displayTarget">0</b></div>
                    <div class="col-4 small text-primary">Actual<br><b id="displayActual">0</b></div>
                    <div class="col-4 small">Balance<br><b id="displayBalance">0</b></div>
                </div>
                <div class="row g-2">
                    <div class="col-4 small mb-2"><span class="count-circle" id="badge-CP">0</span> CP<input type="text" class="form-control form-control-sm cat-input mt-1" data-cat="CP No." placeholder="ID"></div>
                    <div class="col-4 small mb-2"><span class="count-circle" id="badge-Call">0</span> Call<input type="text" class="form-control form-control-sm cat-input mt-1" data-cat="Call IN" placeholder="ID"></div>
                    <div class="col-4 small mb-2"><span class="count-circle" id="badge-IR">0</span> IR<input type="text" class="form-control form-control-sm cat-input mt-1" data-cat="IR" placeholder="ID"></div>
                    <div class="col-4 small mb-2"><span class="count-circle" id="badge-SR">0</span> SR<input type="text" class="form-control form-control-sm cat-input mt-1" data-cat="SR" placeholder="ID"></div>
                    <div class="col-4 small mb-2"><span class="count-circle" id="badge-Drop">0</span> Drop<input type="text" class="form-control form-control-sm cat-input mt-1" data-cat="Drop Call" placeholder="ID"></div>
                    <div class="col-4 small mb-2"><span class="count-circle" id="badge-Camp">0</span> Camp<input type="text" class="form-control form-control-sm cat-input mt-1" data-cat="Campaign" placeholder="ID"></div>
                </div>
                <button onclick="saveWork()" class="btn btn-warning w-100 text-white fw-bold py-3 mt-3 rounded-pill shadow">üöÄ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
            </div>
            <div class="glass-card">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <h6 class="fw-bold m-0 small"><i class="fa-solid fa-history"></i> ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h6>
                    <button id="btnToggleHistory" class="btn btn-sm btn-outline-secondary btn-toggle-history" onclick="toggleHistoryVisibility()">
                        <i class="fa-solid fa-eye"></i> ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
                    </button>
                </div>
                <div id="historyContent" class="hidden-completely">
                    <div class="table-responsive">
                        <table class="table table-sm" style="font-size: 0.75rem;">
                            <thead><tr class="text-secondary"><th>‡πÄ‡∏ß‡∏•‡∏≤</th><th>Case ID</th><th>‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠</th></tr></thead>
                            <tbody id="historyBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div id="tab-cp" class="tab-content hidden-completely">
            <div class="glass-card">
                <h5 class="fw-bold mb-3" style="color:var(--deep-orange)"><i class="fa-solid fa-file-lines me-2"></i>Smart CP Splitter</h5>
                <div class="mb-4">
                    <label class="form-label small fw-bold text-secondary">‡∏ß‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà:</label>
                    <textarea id="cpRawInput" class="form-control shadow-sm" rows="3" placeholder="Paste raw data here..." style="border-radius: 12px; font-size: 0.85rem;" oninput="parseCPData()"></textarea>
                </div>
                <div class="table-responsive shadow-sm" style="border-radius: 15px;">
                    <table class="cp-table-render" id="cpTable">
                        <thead><tr><th colspan="2" class="cp-section-title"><i class="fa-solid fa-info-circle me-2"></i> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th></tr></thead>
                        <tbody>
                            <tr><td class="cp-label-custom">IMSI :</td><td id="td-imsi" class="cp-value-custom" contenteditable="true"></td></tr>
                            <tr><td class="cp-label-custom">4GCell Name:</td><td id="td-4gcell" class="cp-value-custom" contenteditable="true"></td></tr>
                            <tr><td class="cp-label-custom">4G Signal Strength :</td><td id="td-4grsrp" class="cp-value-custom" contenteditable="true"></td></tr>
                            <tr><td class="cp-label-custom">4GSignal Quality :</td><td id="td-4grsrq" class="cp-value-custom" contenteditable="true"></td></tr>
                            <tr><td class="cp-label-custom">5GCell Name:</td><td id="td-5gcell" class="cp-value-custom" contenteditable="true"></td></tr>
                            <tr><td class="cp-label-custom">5G Signal Strength :</td><td id="td-5grsrp" class="cp-value-custom" contenteditable="true"></td></tr>
                            <tr><td class="cp-label-custom">5GSignal Quality :</td><td id="td-5gsinr" class="cp-value-custom" contenteditable="true"></td></tr>
                            <tr><td class="cp-label-custom">Address :</td><td id="td-address" class="cp-value-custom" contenteditable="true"></td></tr>
                            <tr><td class="cp-label-custom">Service Year :</td><td id="td-lat" class="cp-value-custom" contenteditable="true"></td></tr>
                            <tr><td class="cp-label-custom">Arpu :</td><td id="td-long" class="cp-value-custom" contenteditable="true"></td></tr>
                            <tr><td class="cp-label-custom">Remark :</td><td id="td-msisdn" class="cp-value-custom" contenteditable="true"></td></tr>
                            <tr><td class="cp-label-custom">Package Remaining :</td><td id="td-remaining" class="cp-value-custom" contenteditable="true"></td></tr>
                            <tr><td class="cp-label-custom">Package :</td><td colspan="1" id="td-package" class="cp-value-custom" contenteditable="true" style="min-height: 60px; font-size: 0.8rem; line-height: 1.5;"></td></tr>
                        </tbody>
                    </table>
                </div>
                <div class="row g-2 mt-4">
                    <div class="col-4"><button class="btn btn-light w-100 rounded-pill border fw-bold text-secondary" onclick="clearCP()">‡∏•‡πâ‡∏≤‡∏á</button></div>
                    <div class="col-8"><button class="btn btn-warning w-100 rounded-pill text-white fw-bold shadow" onclick="copyCPTable()"><i class="fa-regular fa-copy me-2"></i>‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button></div>
                </div>
            </div>
        </div>

        <div id="tab-dash" class="tab-content hidden-completely">
            <div class="glass-card">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h6 class="fw-bold m-0"><i class="fa-solid fa-chart-pie me-2"></i>Performance Dashboard</h6>
                    <div class="btn-group btn-group-sm">
                        <button class="btn btn-outline-warning active" id="btn-bar" onclick="changeChartType('bar')">Bar</button>
                        <button class="btn btn-outline-warning" id="btn-line" onclick="changeChartType('line')">Line</button>
                    </div>
                </div>
                
                <div class="filter-row mb-3">
    <div class="filter-box"><div class="filter-label">‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á</div><select id="viewType" onchange="updateDashFilters()"><option value="daily">‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</option><option value="monthly">‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</option><option value="quarterly">‡πÑ‡∏ï‡∏£‡∏°‡∏≤‡∏™</option><option value="yearly">‡∏£‡∏≤‡∏¢‡∏õ‡∏µ</option></select></div>
    <div class="filter-box"><div class="filter-label">‡∏õ‡∏µ</div><select id="selYear" onchange="processDashboard()"></select></div>
    <div class="filter-box" id="monthBox"><div class="filter-label" id="lblSub">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div><select id="selSub" multiple onchange="processDashboard()"></select></div>
    <div class="filter-box" id="dayBox"><div class="filter-label">‡∏ß‡∏±‡∏ô</div><select id="selDay" multiple onchange="processDashboard()"></select></div>
    <div class="filter-box"><div class="filter-label">Status</div><select disabled><option>All Data</option></select></div>
</div>

                <div style="height: 250px;"><canvas id="perfChart"></canvas></div>
                
                <div class="table-dash-wrapper mt-3">
                    <table class="table table-sm text-center small table-dash-sticky" style="font-size: 0.65rem;">
                        <thead class="table-light">
                            <tr><th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th><th>CP</th><th>Call</th><th>IR</th><th>SR</th><th>Drop</th><th>Camp</th><th class="table-primary">Actual</th><th>Target</th><th>%</th></tr>
                        </thead>
                        <tbody id="dashTableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="tab-assign" class="tab-content hidden-completely">
            <div class="glass-card">
                <h6 class="fw-bold mb-3">üìÖ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô</h6>
                <div class="row g-2 mb-3">
                    <div class="col-6"><input type="date" id="planDate" class="form-control form-control-sm"></div>
                    <div class="col-3"><select id="planVal" class="form-select form-select-sm"><option value="72">72</option><option value="36">36</option></select></div>
                    <div class="col-3"><button onclick="savePlan()" class="btn btn-warning btn-sm w-100 text-white">‡πÄ‡∏û‡∏¥‡πà‡∏°</button></div>
                </div>
                <div class="table-responsive">
                    <table class="table table-sm text-center small">
                        <thead class="table-light"><tr><th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th><th>Target</th><th>‡∏•‡∏ö</th></tr></thead>
                        <tbody id="planTableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwQwqm_s6_0S6bcBX6xYXb8pLzxDJy5-m5AotyIV4f6uJPxYmTrmNkaXWQsGpk0PwY/exec';
    let currentUser = "", allData = [], allPlans = [], autoSyncTimer = null, chartInstance = null, currentChartType = 'bar';
    const MONTHS_TH = ["‡∏°.‡∏Ñ.","‡∏Å.‡∏û.","‡∏°‡∏µ.‡∏Ñ.","‡πÄ‡∏°.‡∏¢.","‡∏û.‡∏Ñ.","‡∏°‡∏¥.‡∏¢.","‡∏Å.‡∏Ñ.","‡∏™.‡∏Ñ.","‡∏Å.‡∏¢.","‡∏ï.‡∏Ñ.","‡∏û.‡∏¢.","‡∏ò.‡∏Ñ."];

    async function login() {
        const u = document.getElementById('user').value;
        const p = document.getElementById('pass').value;
        if(!u || !p) return;
        document.getElementById('loginInputs').classList.add('hidden-completely');
        document.getElementById('loginStatus').classList.remove('hidden-completely');
        document.getElementById('targetUserDisplay').innerText = `Username: ${u}`;
        try {
            const res = await fetch(`${SCRIPT_URL}?action=login&user=${u}&pass=${p}`);
            const data = await res.json();
            if(data.status === "success") {
                currentUser = data.name;
                document.getElementById('empName').innerText = currentUser;
                document.getElementById('loginSection').classList.add('hidden-completely');
                document.getElementById('mainSection').classList.remove('hidden-completely');
                initData();
                if(!autoSyncTimer) { autoSyncTimer = setInterval(initData, 60000); }
            } else {
                Swal.fire('Error', '‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'error');
                document.getElementById('loginInputs').classList.remove('hidden-completely');
                document.getElementById('loginStatus').classList.add('hidden-completely');
            }
        } catch(e) { location.reload(); }
    }

    async function initData() {
        try {
            const res = await fetch(SCRIPT_URL);
            const json = await res.json();
            allData = json.data.slice(1);
            allPlans = json.plans.slice(1);
            
            const year = new Date().getFullYear();
            let yrHtml = "";
            for(let y=year; y>=year-1; y--) yrHtml += `<option value="${y}">${y+543}</option>`;
            document.getElementById('selYear').innerHTML = yrHtml;
            
            let dyHtml = "";
            for(let d=1; d<=31; d++) dyHtml += `<option value="${d}" selected>${d}</option>`;
            document.getElementById('selDay').innerHTML = dyHtml;

            updateDashFilters();
            updateHomeStats();
            updateHistory();
            renderPlanTable();
            document.getElementById('lastSyncTime').innerText = `Synced: ${new Date().toLocaleTimeString('th-TH')}`;
        } catch(e) { console.error(e); }
    }

    function updateDashFilters() {
        const type = document.getElementById('viewType').value;
        const lbl = document.getElementById('lblSub');
        const sel = document.getElementById('selSub');
        const dayBox = document.getElementById('dayBox');
        const mBox = document.getElementById('monthBox');

        sel.innerHTML = "";
        mBox.classList.remove('hidden-completely');
        dayBox.classList.add('hidden-completely');

        if(type === 'daily' || type === 'monthly') {
            lbl.innerText = "‡πÄ‡∏î‡∏∑‡∏≠‡∏ô";
            MONTHS_TH.forEach((m, i) => {
                const isCur = new Date().getMonth() === i;
                sel.innerHTML += `<option value="${i+1}" ${isCur ? 'selected' : ''}>${m}</option>`;
            });
            if(type === 'daily') dayBox.classList.remove('hidden-completely');
        } else if(type === 'quarterly') {
            lbl.innerText = "‡πÑ‡∏ï‡∏£‡∏°‡∏≤‡∏™";
            [1,2,3,4].forEach(q => sel.innerHTML += `<option value="${q}" selected>Q${q}</option>`);
        } else {
            mBox.classList.add('hidden-completely');
        }
        processDashboard();
    }

    function changeChartType(t) {
        currentChartType = t;
        document.getElementById('btn-bar').classList.toggle('active', t === 'bar');
        document.getElementById('btn-line').classList.toggle('active', t === 'line');
        processDashboard();
    }

function processDashboard() {
        const type = document.getElementById('viewType').value;
        const year = document.getElementById('selYear').value;
        const sub = Array.from(document.getElementById('selSub').selectedOptions).map(o => parseInt(o.value));
        const days = Array.from(document.getElementById('selDay').selectedOptions).map(o => parseInt(o.value));

        let groups = {};
        allData.filter(d => {
            const dt = new Date(d[0]);
            if(d[1] !== currentUser || dt.getFullYear() != year) return false;
            const m = dt.getMonth() + 1;
            const d_val = dt.getDate();
            const q = Math.ceil(m / 3);
            if(type === 'daily') return sub.includes(m) && days.includes(d_val);
            if(type === 'monthly') return sub.includes(m);
            if(type === 'quarterly') return sub.includes(q);
            return true;
        }).forEach(d => {
            const dt = new Date(d[0]);
            let key = "";
            if(type === 'daily') key = d[0].split('T')[0];
            else if(type === 'monthly') key = `${year}-${String(dt.getMonth()+1).padStart(2,'0')}`;
            else if(type === 'quarterly') key = `${year}-Q${Math.ceil((dt.getMonth()+1)/3)}`;
            else key = `${year}`;

            if(!groups[key]) groups[key] = { CP:0, Call:0, IR:0, SR:0, Drop:0, Camp:0, total:0, target:0 };
            if(d[2] === "CP No.") groups[key].CP++;
            else if(d[2] === "Call IN") groups[key].Call++;
            else if(d[2] === "IR") groups[key].IR++;
            else if(d[2] === "SR") groups[key].SR++;
            else if(d[2] === "Drop Call") groups[key].Drop++;
            else if(d[2] === "Campaign") groups[key].Camp++;
            groups[key].total++;
        });

        allPlans.filter(p => {
            const dt = new Date(p[0]);
            if(p[1] !== currentUser || dt.getFullYear() != year) return false;
            const m = dt.getMonth() + 1;
            const d_val = dt.getDate();
            const q = Math.ceil(m / 3);
            if(type === 'daily') return sub.includes(m) && days.includes(d_val);
            if(type === 'monthly') return sub.includes(m);
            if(type === 'quarterly') return sub.includes(q);
            return true;
        }).forEach(p => {
            const dt = new Date(p[0]);
            let key = "";
            if(type === 'daily') key = p[0].split('T')[0];
            else if(type === 'monthly') key = `${year}-${String(dt.getMonth()+1).padStart(2,'0')}`;
            else if(type === 'quarterly') key = `${year}-Q${Math.ceil((dt.getMonth()+1)/3)}`;
            else key = `${year}`;
            if(groups[key]) groups[key].target += parseInt(p[3]);
        });

        const labels = Object.keys(groups).sort();
        if(chartInstance) chartInstance.destroy();
        
        chartInstance = new Chart(document.getElementById('perfChart'), {
            type: currentChartType,
            plugins: [ChartDataLabels], // ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Plugin ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
            data: { 
                labels, 
                datasets: [{ 
                    label: 'Actual', 
                    data: labels.map(l => groups[l].total), 
                    backgroundColor: 'rgba(255, 140, 0, 0.7)', 
                    borderColor: '#ff8c00', 
                    borderWidth: 2,
                    fill: currentChartType === 'line',
                    tension: 0.3
                }]
            },
            options: { 
                responsive: true, 
                maintainAspectRatio: false,
                plugins: {
                    datalabels: { // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç Label
                        anchor: 'end',
                        align: 'top',
                        color: '#444',
                        font: { weight: 'bold', size: 11 },
                        formatter: Math.round
                    },
                    legend: { display: false }
                },
                scales: {
                    y: { beginAtZero: true, grid: { display: false } }
                }
            }
        });

        document.getElementById('dashTableBody').innerHTML = labels.reverse().map(l => {
            const g = groups[l];
            const pct = g.target > 0 ? ((g.total / g.target) * 100).toFixed(0) : 0;
            return `<tr><td>${l}</td><td>${g.CP}</td><td>${g.Call}</td><td>${g.IR}</td><td>${g.SR}</td><td>${g.Drop}</td><td>${g.Camp}</td><td class="table-primary fw-bold">${g.total}</td><td>${g.target}</td><td class="fw-bold text-success">${pct}%</td></tr>`;
        }).join('');
    }

    function updateHomeStats() {
        const todayStr = new Date().toISOString().split('T')[0];
        const myToday = allData.filter(d => d[0].split('T')[0] === todayStr && d[1] === currentUser);
        const plan = allPlans.find(p => p[0].split('T')[0] === todayStr && p[1] === currentUser);
        const target = plan ? parseInt(plan[3]) : 0;
        const actual = myToday.length;
        document.getElementById('displayTarget').innerText = target;
        document.getElementById('displayActual').innerText = actual;
        document.getElementById('displayBalance').innerText = actual - target;
        const badgeMap = { "CP No.": "CP", "Call IN": "Call", "IR": "IR", "SR": "SR", "Drop Call": "Drop", "Campaign": "Camp" };
        Object.keys(badgeMap).forEach(key => {
            const el = document.getElementById(`badge-${badgeMap[key]}`);
            if(el) el.innerText = myToday.filter(d => d[2] === key).length;
        });
        const pct = target > 0 ? Math.min(Math.round((actual/target)*100), 100) : 0;
        document.getElementById('goalProgress').style.width = pct + "%";
        document.getElementById('goalProgress').innerText = pct + "%";
    }

    function updateHistory() {
        const todayStr = new Date().toISOString().split('T')[0];
        const history = allData.filter(d => d[0].split('T')[0] === todayStr && d[1] === currentUser).reverse();
        const tbody = document.getElementById('historyBody');
        if (history.length === 0) { tbody.innerHTML = '<tr><td colspan="3" class="text-center text-muted">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>'; return; }
        tbody.innerHTML = history.map(d => `<tr><td>${new Date(d[0]).toLocaleTimeString('th-TH')}</td><td>${d[3]}</td><td><span class="badge bg-warning text-dark">${d[2]}</span></td></tr>`).join('');
    }

    function toggleHistoryVisibility() {
        const content = document.getElementById('historyContent');
        const btn = document.getElementById('btnToggleHistory');
        if (content.classList.contains('hidden-completely')) {
            content.classList.remove('hidden-completely');
            btn.innerHTML = '<i class="fa-solid fa-eye-slash"></i> ‡∏ã‡πà‡∏≠‡∏ô‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥';
        } else {
            content.classList.add('hidden-completely');
            btn.innerHTML = '<i class="fa-solid fa-eye"></i> ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥';
        }
    }

    async function savePlan() {
        const d = document.getElementById('planDate').value;
        const v = document.getElementById('planVal').value;
        if(!d) return;
        await fetch(SCRIPT_URL, { method:'POST', body: JSON.stringify({ action:'savePlan', user:currentUser, date:d, target:v }) });
        initData();
    }

    function renderPlanTable() {
        const myPlans = allPlans.filter(p => p[1] === currentUser).sort((a,b) => new Date(b[0]) - new Date(a[0]));
        document.getElementById('planTableBody').innerHTML = myPlans.map(p => `<tr><td>${p[0].split('T')[0]}</td><td>${p[3]}</td><td><i class="fa fa-trash text-danger" onclick="deletePlan('${p[0]}')"></i></td></tr>`).join('');
    }

    async function saveWork() {
        const inputs = document.querySelectorAll('.cat-input');
        let items = [];
        inputs.forEach(i => { if(i.value) items.push({ cat: i.dataset.cat, id: i.value }); });
        if(!items.length) return;
        Swal.fire({ title: 'Saving...', didOpen: () => Swal.showLoading() });
        await fetch(SCRIPT_URL, { method:'POST', body: JSON.stringify({ action:'saveWork', user:currentUser, items }) });
        inputs.forEach(i => i.value = "");
        await initData();
        Swal.close();
    }

    function showTab(t) {
        document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden-completely'));
        document.getElementById('tab-'+t).classList.remove('hidden-completely');
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active-btn'));
        document.getElementById('nav-'+t).classList.add('active-btn');
        if(t === 'dash') processDashboard();
    }
function parseCPData() {
        const input = document.getElementById('cpRawInput').value;
        if(!input) return;
        const lines = input.split('\n');
        
        let addr = { bld: "", no: "", soi: "", rd: "", tmb: "", amp: "", prv: "", ldm: "" };
        let provinceIndex = -1;

        lines.forEach((line, index) => {
            // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• IMSI ‡πÅ‡∏•‡∏∞ ‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì (‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏°‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç)
            const cols = line.split(/\t| {2,}/).map(c => c.trim()).filter(c => c !== "");
            if (cols.length >= 8) {
                const timeStr = cols[0], imsi = cols[1], type = cols[2], cellId = cols[4];
                if (type === "4G") {
                    document.getElementById('td-imsi').innerText = imsi.split('.')[0];
                    document.getElementById('td-4gcell').innerText = `${timeStr} ${cellId} 4G`;
                    document.getElementById('td-4grsrp').innerText = cols[6] || "";
                    document.getElementById('td-4grsrq').innerText = cols[7] || "";
                } else if (type === "5G") {
                    document.getElementById('td-5gcell').innerText = `${timeStr} ${cellId} 5G`;
                    document.getElementById('td-5grsrp').innerText = cols[8] || "";
                    document.getElementById('td-5gsinr').innerText = cols[9] || "";
                }
            }

            // --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Values) ---

            // 1. ‡∏î‡∏∂‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£/‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà (‡∏ï‡∏±‡∏î‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ Location/Building Detail ‡∏≠‡∏≠‡∏Å‡πÄ‡∏î‡πá‡∏î‡∏Ç‡∏≤‡∏î)
            if (line.includes("Location/Building Detail :")) {
                let val = line.split("Location/Building Detail :")[1];
                // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏∑‡πà‡∏ô‡∏ï‡πà‡∏≠‡∏ó‡πâ‡∏≤‡∏¢‡πÉ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô ‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏î‡∏≠‡∏≠‡∏Å (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
                addr.bld = val ? val.trim() : "";
            }

            // 2. ‡∏î‡∏∂‡∏á‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà ‡πÅ‡∏•‡∏∞ ‡∏ã‡∏≠‡∏¢
            if (line.includes("Address No. :")) {
                let part = line.split("Address No. :")[1];
                addr.no = part ? part.split("Soi :")[0].trim() : "";
                if (line.includes("Soi :")) {
                    addr.soi = line.split("Soi :")[1].trim();
                }
            }

            // 3. ‡∏î‡∏∂‡∏á‡∏ñ‡∏ô‡∏ô ‡πÅ‡∏•‡∏∞ ‡∏ï‡∏≥‡∏ö‡∏•
            if (line.includes("Road :")) {
                let part = line.split("Road :")[1];
                addr.rd = part ? part.split("Tumbol :")[0].trim() : "";
                if (line.includes("Tumbol :")) {
                    addr.tmb = line.split("Tumbol :")[1].trim();
                }
            }

            // 4. ‡∏î‡∏∂‡∏á‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ ‡πÅ‡∏•‡∏∞ ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î
            if (line.includes("Amphur :")) {
                let part = line.split("Amphur :")[1];
                addr.amp = part ? part.split("Province :")[0].trim() : "";
                if (line.includes("Province :")) {
                    addr.prv = line.split("Province :")[1].trim();
                }
                provinceIndex = index; // ‡∏à‡∏≥‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏à‡∏∏‡∏î‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡πÉ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
            }
        });

        // 5. ‡∏î‡∏∂‡∏á‡∏à‡∏∏‡∏î‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ñ‡∏±‡∏î‡∏à‡∏≤‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î)
        if (provinceIndex !== -1 && lines[provinceIndex + 1]) {
            let ldmVal = lines[provinceIndex + 1].trim();
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ß‡πà‡∏≤‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÅ‡∏ï‡πà‡∏Ç‡∏µ‡∏î
            addr.ldm = (ldmVal && ldmVal !== "-") ? ldmVal : "";
        }

        // --- ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î Format Address ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• ---
        let formattedAddr = [];
        
        if (addr.no && addr.no !== "-") formattedAddr.push(addr.no);
        if (addr.bld && addr.bld !== "-") formattedAddr.push(addr.bld); 
        if (addr.rd && addr.rd !== "-") formattedAddr.push("‡∏ñ‡∏ô‡∏ô " + addr.rd);
        if (addr.soi && addr.soi !== "-") formattedAddr.push("‡∏ã‡∏≠‡∏¢ " + addr.soi);
        if (addr.tmb && addr.tmb !== "-") formattedAddr.push("‡∏ï." + addr.tmb);
        if (addr.amp && addr.amp !== "-") formattedAddr.push("‡∏≠." + addr.amp);
        if (addr.prv && addr.prv !== "-") formattedAddr.push("‡∏à." + addr.prv);
        if (addr.ldm) formattedAddr.push("‡∏à‡∏∏‡∏î‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï " + addr.ldm);

        // ‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏™‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á Address ‡πÅ‡∏•‡∏∞‡∏•‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á Remark (td-msisdn) ‡πÉ‡∏´‡πâ‡∏ß‡πà‡∏≤‡∏á
        document.getElementById('td-address').innerText = formattedAddr.join(" ");
        document.getElementById('td-msisdn').innerText = ""; 
    }
    function logout() { localStorage.clear(); location.reload(); }

    function updateClock() {
        const now = new Date();
        document.getElementById('bigClock').innerText = now.toLocaleTimeString('th-TH', { hour12: false });
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        document.getElementById('todayDateLabel').innerText = now.toLocaleDateString('th-TH', options);
    }
    setInterval(updateClock, 1000);
    updateClock();

function copyCPTable() {
        let text = "";
        const rows = document.querySelectorAll('#cpTable tbody tr');
        
        rows.forEach(row => {
            const label = row.querySelector('.cp-label-custom')?.innerText || "";
            const value = row.querySelector('.cp-value-custom')?.innerText || "";
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á value ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å
            if (value.trim() !== "") {
                text += label + " " + value + "\n";
            }
        });

        if (!text) {
            Swal.fire({ icon: 'warning', title: '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å' });
            return;
        }

        navigator.clipboard.writeText(text.trim()).then(() => {
            Swal.fire({ 
                icon: 'success', 
                title: '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß!', 
                timer: 1000, 
                showConfirmButton: false 
            });
        }).catch(err => {
            console.error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏î‡πâ:', err);
            Swal.fire({ icon: 'error', title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å' });
        });
    }
function clearCP() {
        // 1. ‡∏•‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö (Textarea)
        const rawInput = document.getElementById('cpRawInput');
        if (rawInput) {
            rawInput.value = ""; //
        }

        // 2. ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ó‡∏∏‡∏Å Element ‡∏ó‡∏µ‡πà‡∏°‡∏µ Class ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Ñ‡πà‡∏≤ (cp-value-custom) 
        // ‡πÅ‡∏•‡πâ‡∏ß‡∏•‡πâ‡∏≤‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà
        const allValueCells = document.querySelectorAll('.cp-value-custom');
        allValueCells.forEach(cell => {
            cell.innerText = ""; // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≠‡∏Å‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
        });

        // 3. ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£ Reset
        if (typeof Swal !== 'undefined') {
            Swal.fire({
                icon: 'success',
                title: 'Reset ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß',
                timer: 800,
                showConfirmButton: false
            });
        }
    }
</script>
</body>
</html>